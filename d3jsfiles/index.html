<html>
  <head>
    <title>MADI</title>
    <link rel="stylesheet" type="text/css" href="style/all.css" />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css"
    />
    <script src="https://d3js.org/d3.v5.min.js"></script>
    <script src="https://d3js.org/topojson.v2.min.js" charset="utf-8"></script>
    <script src="https://d3js.org/d3-tile.v0.0.min.js"></script>
    <script src="https://api.tiles.mapbox.com/mapbox-gl-js/v0.53.0/mapbox-gl.js"></script>
    <script src="https://d3js.org/d3.v5.min.js"></script>
    <link
      href="https://api.tiles.mapbox.com/mapbox-gl-js/v0.53.0/mapbox-gl.css"
      rel="stylesheet"
    />
    <style></style>
  </head>

  <body>
    <div id="filters"></div>
    <div id="my_dataviz"></div>
  </body>

  <script id="scatterplot">
    var margin = { top: 10, right: 30, bottom: 30, left: 60 },
      width = 800 - margin.left - margin.right,
      height = 400 - margin.top - margin.bottom;
    var svg = d3
      .select("#my_dataviz")
      .append("svg")
      .attr("width", width + margin.left + margin.right)
      .attr("height", height + margin.top + margin.bottom)
      .append("g")
      .attr("transform", "translate(" + margin.left + "," + margin.top + ")");

    const load = async function() {
      // filter buttons
      // const filters = d3.select("#filters");

      // const data = await d3.csv("output.csv", d3.autoType);
      // categories = ["Amount", "V1"];
      // //   console.log(data);
      // categories.forEach(d => {
      //   filters
      //     .append("button")
      //     .attr("class", "category")
      //     .attr("value", d)
      //     .text(d);
      // });

      // const category = d3.selectAll(".category");
      // category.on("click", function() {
      //   var button = d3.select(this);

      //   let value = button.attr("value");
      //   const amountExtent = d3.extent(data, d => d[value]);
      //   changeAxis(value, amountExtent);

      //   // var x = d3
      //   //   .scaleLinear()
      //   //   .domain(amountExtent)
      //   //   .range([0, width]);
      //   // var color1 = d3
      //   //   .scaleSequential()
      //   //   .domain([0, 1])
      //   //   .interpolator(d3.interpolateReds);

      //   // svg
      //   //   .append("g")
      //   //   .attr("transform", "translate(0," + height + ")")
      //   //   .call(d3.axisBottom(x));
      // });

      // // Add X axis
      // const amountExtent = d3.extent(data, d => d["Amount"]);

      // var x = d3
      //   .scaleLinear()
      //   .domain(amountExtent)
      //   .range([0, width]);

      // var color1 = d3
      //   .scaleSequential()
      //   .domain([0, 1])
      //   .interpolator(d3.interpolateOranges);

      // var xAxis = svg
      //   .append("g")
      //   .attr("transform", "translate(0," + height + ")")
      //   .call(d3.axisBottom(x));

      // // Add Y axis
      // var y = d3
      //   .scaleLinear()
      //   .domain([0, 1])
      //   .range([height, 0]);
      // svg.append("g").call(d3.axisLeft(y));

      // // Add dots
      // svg
      //   .append("g")
      //   .selectAll("dot")
      //   .data(data)
      //   .enter()
      //   .append("circle")

      //   .attr("cx", function(d) {
      //     return x(d.Amount);
      //   })
      //   .attr("cy", function(d) {
      //     return y(1 - d.class_prob);
      //   })
      //   .attr("r", 1.5)
      //   .style("opacity", 0.3)
      //   .style("fill", function(d) {
      //     return color1(d.class_prob);
      //   });
      // // Labels for axis x and y
      // svg
      //   .append("text")
      //   .attr("text-anchor", "end")
      //   .attr("x", width)
      //   .attr("y", height + margin.top + 20)
      //   .text("X axis title");

      // svg
      //   .append("text")
      //   .attr("text-anchor", "end")
      //   .attr("transform", "rotate(-90)")
      //   .attr("y", -margin.left + 20)
      //   .attr("x", -margin.top)
      //   .text("Anomaly Score");

      // svg
      //   .selectAll("circle")
      //   .transition()
      //   .delay(function(d, i) {
      //     //   console.log(i);
      //     return i * 3;
      //   })
      //   .duration(2000)
      //   .attr("cx", function(d) {
      //     return x(d.Amount);
      //   })
      //   .attr("cy", function(d) {
      //     return y(1 - d.class_prob);
      //   });

      // function changeAxis(value, extent) {
      //   x.domain(extent);
      //   console.log(extent);
      //   xAxis
      //     .transition()
      //     .duration(1000)
      //     .call(d3.axisBottom(x));

      //   svg
      //     .selectAll("circle")
      //     .data(data)
      //     .transition()
      //     .duration(1000)
      //     .attr("cx", function(d) {
      //       return x(d[value]);
      //     })
      //     .attr("cy", function(d) {
      //       return y(1 - d.class_prob);
      //     });
      // }
      const data = await d3.csv("output.csv", d3.autoType);

      const scoreExtent = d3.extent(data, d => d.class_prob);
      const scoreScale = d3
        .scaleBand()
        .domain([0, 0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 0.9, 1])
        .range([0, width])
        .padding(0.01);
      console.log(scoreScale(0.5));

      const amountExtent = d3.extent(data, d => d.Amount);
      const amountScale = d3
        .scaleLinear()
        .domain(amountExtent)
        .range([0, width]);
      console.log(amountExtent);
    };
    load();
  </script>
</html>
